// src/pages/dashboard/MalwareDetailView.js
import { useEffect, useState } from 'react';
import { useParams } from 'react-router-dom';
import apiUrl from '../../apiClient';

function Field({ label, children }) {
  return (
    <div style={{ marginBottom: '8px' }}>
      <div style={{ fontWeight: 700, marginBottom: 4 }}>{label}</div>
      <div>{children || '-'}</div>
    </div>
  );
}

function List({ items }) {
  if (!items || items.length === 0) return <div>-</div>;
  return <ul className="list">{items.map((v, i) => <li key={i}>{v}</li>)}</ul>;
}

function MalwareDetailView() {
  const { id } = useParams();
  const [data, setData] = useState(null);

  useEffect(() => {
    fetch(apiUrl(`/api/malware/${id}`)).then(r=>r.json()).then(setData).catch(()=>{});
  }, [id]);

  if (!data) return <div className="panel-card">Загрузка...</div>;

  return (
    <div className="panel-card">
      <h2>{data.name}</h2>
      <Field label="Тип">{data.type}</Field>
      <Field label="Семейство">{data.family}</Field>
      <Field label="Описание">{data.description}</Field>
      <Field label="Первая фиксация">{data.first_seen}</Field>
      <Field label="Последняя фиксация">{data.last_seen}</Field>
      <Field label="Хэши"><List items={data.hashes} /></Field>
      <Field label="Возможности"><List items={data.capabilities} /></Field>
      <Field label="Источники"><List items={data.sources} /></Field>
    </div>
  );
}

export default MalwareDetailView;

